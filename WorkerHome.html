<!DOCTYPE html>
<html lang="en">
<head>
  <title>PikaShift</title>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel='stylesheet' href='fullcalendar/fullcalendar.css' />

  <link rel="stylesheet" href="MessageTab.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="MessageTab.js"></script>
  <script src="HelpoutTab.js"></script>
  <script src="AbsenceTab.js"></script>

  <script src='fullcalendar/lib/jquery.min.js'></script>
  <script src='fullcalendar/lib/moment.min.js'></script>
  <script src='fullcalendar/fullcalendar.js'></script>

  <!-- Bootstrap Date-Picker Plugin -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/js/bootstrap-datepicker.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/css/bootstrap-datepicker3.css"/>
    <style>.bootstrap-iso .formden_header h2, .bootstrap-iso .formden_header p, .bootstrap-iso form{font-family: Arial, Helvetica, sans-serif; color: black}.bootstrap-iso form button, .bootstrap-iso form button:hover{color: white !important;} .asteriskField{color: red;}</style>

  <script src="http://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.js"></script>
  <link rel='stylesheet' href="http://cdn.jsdelivr.net/qtip2/3.0.3/jquery.qtip.min.css"/>


  <script>
// Final initialization entry point: the Javascript code inside this block
// runs at the end of start-up when the page has finished loading.
$(document).ready(function()
{
  $('#calendar').fullCalendar({
      defaultDate: '2017-04-17',
      defaultView: 'agendaWeek',
      editable: true,
      //eventLimit: true, // allow "more" link when too many events
      header: {
        left: 'prev, next',
        center: 'title',
        right: 'agendaWeek, agendaDay'
      },
      height: 'auto',
      minTime: '9:00',
      maxTime: '21:00',
      allDaySlot: false,
      slotDuration: "1:00:00",
      selectable: true,
      // businessHours:  //used to set when the worker's shifts are
      // {  
      //   dow: [0,1,2,3,4,5,6],
      //   start: '9:00',
      //   end: '21:00',
      // },
      selectConstraint: 
        {
          dow: [1,3,5],
          start: '13:00',
          end: '21:00',
        },

      events: [ //ABSENCES - hardcoded
          {
              title  : 'absent',
              start  : '2017-04-15T13:00:00',
              end    : '2017-04-15T14:00:00',
              color  :'red',
              startEditable : false,
              durationEditable : false
          },
          {
              title  : 'absent',
              start  : '2017-04-10T18:00:00',
              end    : '2017-04-10T21:00:00',
              color  :'red',
              startEditable : false,
              durationEditable : false,
          },
          {
              title  : 'workhour',
              start  : '2017-04-17T13:00:00',
              end    : '2017-04-17T21:00:00',
              color  :'green',
              startEditable : false,
              durationEditable : false,
              rendering: 'background',

          },
          {
              title  : 'workhour',
              start  : '2017-04-19T13:00:00',
              end    : '2017-04-19T21:00:00',
              color  :'green',
              startEditable : false,
              durationEditable : false,
              rendering: 'background',

          },
          {
              title  : 'workhour',
              start  : '2017-04-21T13:00:00',
              end    : '2017-04-21T21:00:00',
              color  :'green',
              startEditable : false,
              durationEditable : false,
              rendering: 'background',
          }
      ],
      select: function(startDate, endDate, jsEvent, view) {
        startTime = startDate._d;
        startTime.setHours(startTime.getHours() + 4); //actual start time
        endTime = endDate._d;
        endTime.setHours(endTime.getHours() + 4); //actual end time
        //update new absence form
        document.getElementById("absences").innerHTML = absenceForm;
        
        var dateText = new Date();
        var month = startTime.getMonth() + 1
        var date = startTime.getDate();
        if (startTime.getMonth() < 10) {
          month = '0' + month;
        }
        if (startTime.getDate() < 10) {
          date = '0' + date;
        }
        dateText = startTime.getFullYear() + '-' + month + '-' + date; 
        $("[name=absence-date]").val(dateText);
        var startText = startTime.getHours() + "am";
        var endText = endTime.getHours() + 'am';
        if (startTime.getHours() > 12) {startText = (startTime.getHours() - 12)+ 'pm';}
        else if (startTime.getHours() == 12) {startText = startTime.getHours() + 'pm';}
        if (endTime.getHours() > 12) { endText = (endTime.getHours() - 12) + 'pm';}
        else if (endTime.getHours() == 12) {endText = endTime.getHours() + 'pm';}
      
        $("#absence-start-time").val(startText);
        $("#absence-end-time").val(endText);
    }
  });

  $('#allAbsences').fullCalendar({
      defaultView: 'agendaWeek',
      editable: true,
      //eventLimit: true, // allow "more" link when too many events
      header: {
        left: 'prev, next',
        center: 'title',
        right: 'agendaWeek, agendaDay'
      },
      height: 'auto',
      minTime: '9:00',
      maxTime: '21:00',
      allDaySlot: false,
      slotDuration: "1:00:00",
      selectable: false,

      events: [ //HELPOUTS - hardcoded
          {
              title  : 'Helpout',
              start  : '2017-04-19T13:00:00',
              end    : '2017-04-19T15:00:00',
              color  : 'blue',
              startEditable : false,
              durationEditable : false,
          },
          {
              title  : 'Helpout',
              start  : '2017-04-19T18:00:00',
              end    : '2017-04-19T20:00:00',
              color  :'blue',
              startEditable : false,
              durationEditable : false,
          }
      ],
      eventClick: function(event, jsEvent, view) {
        var start = new Date();
        start.setHours(event.start._d.getHours() + 4); //actual start time
        var end = new Date();
        end.setHours(event.end._d.getHours() + 4); //actual end time
        //update new absence form
        document.getElementById("helpouts").innerHTML = helpoutForm;
        
        var dateText = new Date();
        var month = start.getMonth() + 1;
        var date = start.getDate();
        if (start.getMonth() < 10) {
          month = '0' + month;
        }
        if (start.getDate() < 10) {
          date = '0' + date;
        }
        dateText = start.getFullYear() + '-' + month + '-' + date; 
        $("[name=helpout-date]").val(dateText);
        var startText = start.getHours() + "am";
        var endText = end.getHours() + 'am';
        if (start.getHours() > 12) {startText = (start.getHours() - 12)+ 'pm';}
        else if (start.getHours() == 12) {startText = start.getHours() + 'pm';}
        if (end.getHours() > 12) { endText = (end.getHours() - 12) + 'pm';}
        else if (end.getHours() == 12) {endText = end.getHours() + 'pm';}
      
        $("#helpout-start-time").val(startText);
        $("#helpout-end-time").val(endText);
        },
    });
});

  function addEvent(startTime, endTime) {
    var newEvent = new Object();
    newEvent.title = 'absent';
    newEvent.start = startTime;
    newEvent.end = endTime;
    newEvent.color = 'red';
    newEvent.startEditable = false;
    newEvent.durationEditable = false;
    newEvent.overlap = true;
    $('#calendar').fullCalendar('renderEvent', newEvent, true)
  }

$(document).on('click', '#all-tab', function(e) {
    setTimeout(function(){
      $('.fc-agendaWeek-button').click();
    }, 150) 
})

</script>

</head>
<body>

<!-- Navigation Bar --> 
<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="#">PikaShift</a>
    </div>
    <ul class="nav navbar-nav">
      <li id="calendar-tab" class="active"><a data-toggle="tab" href="#calendar">My Schedule</a></li>
      <li id="all-tab"><a data-toggle="tab" href="#allAbsences"> All Absences</a></li>
    </ul>
    
    <ul class="nav navbar-nav navbar-right">
      <li><a href="#"><span class="glyphicon glyphicon-user"></span> Welcome, Pikachu</a></li>
      
    </ul>  </div>
</nav>

<!-- Navigation Bar --> 


<div class="container col-md-6 column"> <!--- Calender Code -->
  <div class="tab-content">
    <div id = "calendar" class="tab-pane fade in active"></div>
    <div id = "allAbsences" class="tab-pane fade"> </div>
  </div>
</div> <!-- End Calender Code -->

<!-- Tabs Code -->



<div class="container col-md-5 column">

  <ul class="nav nav-tabs nav-justified">
    <li class="active" id="notif-tab"><a data-toggle="tab" href="#notifs">Notifications</a></li>
    <li id="absence-tab"><a data-toggle="tab" href="#absences">Absences</a></li>
    <li id="helpout-tab"><a data-toggle="tab" href="#helpouts">Helpouts</a></li>
    
  </ul>

  <div class="tab-content">

    <div id="notifs" class="tab-pane fade in active">
      <button type="button" class="btn btn-primary btn-block" id="new-msg-btn"> New Message</button>

      <div id="msg-inbox" class="col-md-12">
        <!-- Begin Message 1 : Vaporeon --> 
        <div id="msg-inbox-a" class="msg-card">
          <!-- Message Header --> 
          <div class="row" >
            <div class="col-md-5"><h4> Vaporeon </h4> </div>
            <div class="col-md-4"> <h5>8pm, March 14</h5> </div>
            <div class="col-md-3"> 
              <button type="button" class="btn btn-danger btn-sm" id="msg-seen-a"> Mark Seen </button> 
            </div>
          </div>
        <!--- Message Body --> 
          <div class="row">
            <div class="col-md-12 well"> 
                Table 5 needs coffeee. Table 2,3 needs Cleaning. Reservation for Mr. Lapras at 9pm. 
                Dishwasher Duty today.
            </div>
          </div>
        </div>  <!-- End Of Message 1 -->

        <!-- Begin Message 2 --> 
        <div id="msg-inbox-b" class="msg-card">
          <!-- Message Header --> 
          <div class="row" >
            <div class="col-md-5"><h4> Manager </h4> </div>
            <div class="col-md-4"> <h5>9pm, March 2</h5> </div>
            <div class="col-md-3"> 
              <button type="button" class="btn btn-danger btn-sm" id="msg-seen-b"> Mark Seen </button> 
            </div>
          </div>
        <!--- Message Body --> 
          <div class="row">
            <div class="col-md-12 well"> Holiday Tomorrow due to Snow Day </div>
          </div>
        </div>  <!-- End Of Message 2 -->

    </div> <!-- Msg Inbox -->


    </div>

    <!-- Absence -->
    <div id="absences" class="tab-pane fade">
      <button type="button" id="newAbsence" class="btn btn-primary btn-block"> New Absence</button>

      <!-- Absence Ends -->

      <table style="width:100%">
        <tr class="lower-border">
          <td align="center">
            <h5>Mar 15, 2017</h5>
          </td>
          <td align="center">
            <h5>1pm - 2pm</h5>
          </td>
          <td align="center">
            <h5>Family</h5>
          </td>
        </tr>
        <tr class="lower-border">
          <td align="center">
            <h5>Mar 10, 2017</h5>
          </td>
          <td align="center">
            <h5>6pm - 9pm</h5>
          </td>
          <td align="center">
            <h5>Vacation</h5>
          </td>
        </tr>
      </table>
    </div>

    <!-- End Absence -->

    <div id="helpouts" class="tab-pane fade">
      <button type="button" class="btn btn-primary btn-block" id = "newHelpout"> New Helpout</button>

      <div class="helpout-title" style="padding-top: 10px"><h4> Upcoming Helpouts</h4></div>
      <table style="width:100%">
        <tr class="lower-border top-border">
          <td align="center">
            <h5>Apr 21, 2017</h5>
          </td>
          <td align="center">
            <h5>1pm - 2pm</h5>
          </td>
        </tr>
        <tr class="lower-border">
          <td align="center">
            <h5>Apr 28, 2017</h5>
          </td>
          <td align="center">
            <h5>6pm - 8pm</h5>
          </td>
        </tr>
      </table>

      <div class="helpout-title"><h4> Previous Helpouts</h4></div>
      <table style="width:100%">
        <tr class="lower-border top-border">
          <td align="center">
            <h5>Mar 15, 2017</h5>
          </td>
          <td align="center">
            <h5>1pm - 2pm</h5>
          </td>
        </tr>
        <tr class="lower-border">
          <td align="center">
            <h5>Mar 10, 2017</h5>
          </td>
          <td align="center">
            <h5>6pm - 9pm</h5>
          </td>
        </tr>
      </table>
    </div>
    
  </div>
  <div class="container col-md-1"></div>
</div>  <!-- End Tabs Code -->

</body>
</html>